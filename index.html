<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI HR Portal Prototype v9.0</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #f8f9fa;
            color: #111827;
        }
        :root { --chart-max-height: 300px; }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .btn { display: inline-flex; align-items: center; gap: 0.5rem; justify-content: center; }
        .btn-primary {
            background-color: #111827; color: white; border-radius: 0.5rem; padding: 0.5rem 1rem; font-weight: 500; transition: background-color 0.2s;
        }
        .btn-primary:hover { background-color: #374151; }
        .btn-secondary {
            background-color: #f3f4f6; color: #111827; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 0.5rem 1rem; font-weight: 500; transition: background-color 0.2s;
        }
        .btn-secondary:hover { background-color: #e5e7eb; }
        #role-switcher { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-link-active { background-color: #f3f4f6; color: #111827; }
        .nav-link-inactive { color: #6b7280; }
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: flex; align-items: center; justify-content: center;
            z-index: 2000;
        }
        .tag {
            display: inline-block;
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
        }
    </style>
</head>
<body class="antialiased">
    <div id="portal-container" class="grid min-h-screen w-full md:grid-cols-[220px_1fr] lg:grid-cols-[280px_1fr]">
        <div id="sidebar-container"></div>
        <div class="flex flex-col">
            <header id="header-container"></header>
            <main id="app-root" class="flex-1 p-4 lg:p-6"></main>
        </div>
    </div>

    <!-- Modal Container -->
    <div id="modal-container"></div>

    <div id="role-switcher" class="card p-2 space-y-2">
        <h3 class="text-xs font-bold text-center text-gray-500 uppercase">Switch Role</h3>
        <select id="role-select" class="w-full p-2 text-sm border rounded-md">
            <option value="Руководитель">Руководитель</option>
            <option value="Рекрутер">Рекрутер</option>
            <option value="Клиент">Клиент</option>
            <option value="Кандидат">Кандидат</option>
            <option value="Public">Public (Login)</option>
        </select>
    </div>

    <script>
        // --- DATA & STATE ---
        const icons = {
            dashboard: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>`,
            vacancies: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>`,
            candidates: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>`,
            clients: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>`,
            assistant: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>`,
            calendar: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>`,
            status: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>`,
            plus: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>`,
            back: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>`,
            close: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>`,
            search: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>`,
            filter: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" /></svg>`,
            users: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>`,
            resume: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`,
            sparkles: `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg>`,
        };
        
        const mockData = {
            users: [ { id: 1, name: 'Анна', role: 'Руководитель' }, { id: 2, name: 'Ольга', role: 'Рекрутер' }],
            clients: [ { id: 101, name: 'Global Tech Inc.', contact: 'Виктор Петров', email: 'v.petrov@gti.com' }, { id: 102, name: 'Cyber Solutions', contact: 'Ирина Сергеева', email: 'i.sergeeva@cybersol.com' }, { id: 103, name: 'Innovate LLC', contact: 'Павел Новиков', email: 'p.novikov@innovate.com' }, { id: 104, name: 'Data Systems', contact: 'Мария Лебедева', email: 'm.lebedeva@datasys.com' }, { id: 105, name: 'Future Creations', contact: 'Алексей Смирнов', email: 'a.smirnov@future.com' }, ],
            candidates: [
                { id: 201, name: 'Сергей Романов', position: 'Senior Java Developer', status: 'Интервью с клиентом', avatar: 'https://picsum.photos/seed/user201/40/40', match: 92, matches: ['Опыт с Kafka: 3 года', 'Микросервисная архитектура'], isGem: true, salary: '$6000', source: 'LinkedIn', summary: 'Опытный Java-разработчик с фокусом на backend-системах и микросервисах.' },
                { id: 202, name: 'Мария Иванова', position: 'Frontend Developer', status: 'Техническое интервью', avatar: 'https://picsum.photos/seed/user202/40/40', match: 88, matches: ['React: 4 года', 'TypeScript'], isGem: false, salary: '$4500', source: 'Djinni', summary: 'Сильный Frontend-специалист с экспертизой в React и TypeScript.' },
                { id: 203, name: 'Алексей Петров', position: 'DevOps Engineer', status: 'Оффер', avatar: 'https://picsum.photos/seed/user203/40/40', match: 85, matches: ['Kubernetes, Terraform', 'CI/CD (GitLab)'], isGem: false, salary: '$5500', source: 'Referral', summary: 'DevOps-инженер с опытом в AWS и автоматизации CI/CD.' },
                { id: 204, name: 'Елена Сидорова', position: 'UI/UX Designer', status: 'Новый', avatar: 'https://picsum.photos/seed/user204/40/40', match: 75, matches: ['Figma, Sketch', 'User Research'], isGem: false, salary: '$3500', source: 'Website', summary: 'Дизайнер с фокусом на пользовательских исследованиях и прототипировании.' },
                { id: 205, name: 'Дмитрий Кузнецов', position: 'Project Manager', status: 'Отклонен', avatar: 'https://picsum.photos/seed/user205/40/40', match: 60, matches: ['Agile, Scrum', 'Jira, Confluence'], isGem: false, salary: '$5000', source: 'LinkedIn', summary: 'PM с опытом управления командами в Agile-среде.' },
            ],
            vacancies: [ 
                { id: 301, title: 'Senior Java Developer', client: 'Global Tech Inc.', recruiter: 'Ольга', status: 'В работе', stats: {found: 120, screened: 45, interview: 12 } }, 
                { id: 302, title: 'DevOps Engineer', client: 'Cyber Solutions', recruiter: 'Ольга', status: 'В работе', stats: {found: 80, screened: 30, interview: 8 } }, 
                { id: 303, title: 'UI/UX Designer', client: 'Innovate LLC', recruiter: 'Анна', status: 'На удержании', stats: {found: 250, screened: 80, interview: 25 } }, 
                { id: 304, title: 'Frontend Developer', client: 'Global Tech Inc.', recruiter: 'Ольга', status: 'В работе', stats: {found: 150, screened: 55, interview: 15 } }, 
                { id: 305, title: 'Project Manager', client: 'Data Systems', recruiter: 'Анна', status: 'Закрыта', stats: {found: 320, screened: 110, interview: 32 } }, 
            ],
            kanban: { 'Новые': [204], 'Скрининг': [205], 'Тех. интервью': [202], 'Интервью с клиентом': [201], 'Оффер': [203] }
        };
        
        let state = {
            currentUserRole: 'Руководитель',
            assistant: {
                name: 'Jessica',
                avatar: '✨',
                persona: 'Профессиональный'
            }
        };

        // --- RENDER FUNCTIONS ---
        
        function getNavLinkClass(currentPath, targetPath) { return (currentPath === targetPath) ? 'nav-link-active' : 'nav-link-inactive hover:text-gray-900'; }

        function renderSidebar(role, currentPath) {
            const sidebarContainer = document.getElementById('sidebar-container');
            if (role === 'Public') {
                sidebarContainer.innerHTML = '';
                document.getElementById('portal-container').className = 'grid min-h-screen w-full grid-cols-1';
                return;
            }
            document.getElementById('portal-container').className = 'grid min-h-screen w-full md:grid-cols-[220px_1fr] lg:grid-cols-[280px_1fr]';
            
            const commonLinks = `<a href="#/settings/my-assistant" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/settings/my-assistant')}">${icons.assistant} MyAssistant</a>`;
            const navLinks = {
                'Руководитель': `
                    <a href="#/" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/')}">${icons.dashboard} Dashboard</a>
                    <a href="#/vacancies" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/vacancies')}">${icons.vacancies} Вакансии</a>
                    <a href="#/clients" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/clients')}">${icons.clients} Клиенты</a>
                    ${commonLinks}
                `,
                'Рекрутер': `
                    <a href="#/" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/')}">${icons.dashboard} Dashboard</a>
                    <a href="#/vacancies" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/vacancies')}">${icons.vacancies} Вакансии</a>
                    <a href="#/candidates" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/candidates')}">${icons.candidates} Кандидаты</a>
                    <a href="#/clients" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/clients')}">${icons.clients} Клиенты</a>
                    <a href="#/calendar" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/calendar')}">${icons.calendar} Календарь</a>
                    ${commonLinks}
                `,
                'Клиент': `<a href="#/client/dashboard" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/client/dashboard')}">${icons.vacancies} Мои вакансии</a>`,
                'Кандидат': `<a href="#/candidate/status/1" class="flex items-center gap-3 rounded-lg px-3 py-2 transition-all ${getNavLinkClass(currentPath, '/candidate/status/1')}">${icons.status} Статус моей заявки</a>`
            };
            sidebarContainer.innerHTML = `<div class="hidden h-full border-r bg-white md:block"><div class="flex h-full max-h-screen flex-col gap-2"><div class="flex h-14 items-center border-b px-4 lg:h-[60px] lg:px-6"><a href="#/" class="flex items-center gap-2 font-semibold"><span>AI HR Portal</span></a></div><div class="flex-1"><nav class="grid items-start px-2 text-sm font-medium lg:px-4">${navLinks[role] || ''}</nav></div></div></div>`;
        }
        
        function renderHeader(role) {
            const headerContainer = document.getElementById('header-container');
            if (role === 'Public') { headerContainer.innerHTML = ''; return; }
            headerContainer.innerHTML = ` <header class="flex h-14 items-center gap-4 border-b bg-white px-4 lg:h-[60px] lg:px-6"> <div class="w-full flex-1"> <div class="relative"> <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"> ${icons.search} </div> <input type="search" placeholder="Глобальный поиск по кандидатам, вакансиям..." class="w-full appearance-none bg-gray-100 border-none rounded-md pl-10 pr-4 py-2 text-sm" /> </div> </div> <div class="flex items-center gap-4"> <span class="text-sm font-medium">${role}</span> <div class="relative group"> <img src="https://picsum.photos/seed/avatar/40/40" class="h-8 w-8 rounded-full cursor-pointer" alt="Avatar"> <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-20 hidden group-hover:block"> <a href="#/settings/my-assistant" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Настройки</a> <a href="#/login" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Выход</a> </div> </div> </div> </header> `;
        }
        
        function renderLoginPage() { return ` <div class="flex items-center justify-center h-screen bg-gray-100"> <div class="w-full max-w-md"> <div class="card p-8"> <h2 class="text-2xl font-bold text-center mb-1">Вход в систему</h2> <p class="text-center text-gray-500 mb-6">AI HR Portal</p> <div class="space-y-4"> <div> <label class="text-sm font-medium">Email</label> <input type="email" placeholder="email@example.com" class="w-full mt-1 p-2 border rounded-md"> </div> <div> <label class="text-sm font-medium">Пароль</label> <input type="password" class="w-full mt-1 p-2 border rounded-md"> </div> <a href="#/" class="w-full btn btn-primary">Войти</a> <a href="#/forgot-password" class="text-sm text-center block hover:underline">Забыли пароль?</a> </div> </div> </div> </div> `; }
        
        function renderDateRangeFilter() { return ` <div class="flex justify-end"> <select class="p-2 text-sm border rounded-md bg-white shadow-sm"> <option>Текущая неделя</option> <option>Прошлая неделя</option> <option selected>Текущий месяц</option> <option>Прошлый месяц</option> <option>Текущий квартал</option> <option>С начала года</option> </select> </div> `; }

        function renderDashboardManager() { setTimeout(() => { new Chart(document.getElementById('teamLoadChart'), { type: 'doughnut', data: { labels: ['Ольга', 'Анна'], datasets: [{ label: 'Активных вакансий', data: [5, 3], backgroundColor: ['#3b82f6', '#8b5cf6'] }] }, options: { maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } } }); new Chart(document.getElementById('revenueChart'), { type: 'line', data: { labels: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн'], datasets: [{ label: 'Доход', data: [12000, 19000, 15000, 24000, 22000, 31000], fill: false, borderColor: '#10b981', tension: 0.1 }] }, options: { maintainAspectRatio: false, scales: { y: { beginAtZero: true } } } }); }, 0); return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Сводная панель руководителя</h1> ${renderDateRangeFilter()} </div> <div class="card p-4 mb-4 bg-blue-50 border-blue-200"> <h3 class="font-semibold text-blue-800 flex items-center gap-2">${state.assistant.avatar} Отчет от ${state.assistant.name} за Сентябрь</h3> <p class="text-sm text-blue-700 mt-2">Мы наблюдаем позитивную динамику: среднее время закрытия вакансии сократилось на 10% до 32 дней. Однако, на вакансии 'DevOps Engineer' наблюдается узкое место на этапе технического интервью, где конверсия ниже средней. Рекомендую обсудить с клиентом сложность тестового задания.</p> </div> <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-4"> <div class="card p-4"> <h3 class="text-sm font-medium text-gray-500">Общий доход</h3> <p class="text-3xl font-bold">$123,456</p> </div> <div class="card p-4"> <h3 class="text-sm font-medium text-gray-500">Активных вакансий</h3> <p class="text-3xl font-bold">8</p> </div> <div class="card p-4"> <h3 class="text-sm font-medium text-gray-500">Среднее время закрытия</h3> <p class="text-3xl font-bold">32 дня</p> </div> <div class="card p-4"> <h3 class="text-sm font-medium text-gray-500">Новых клиентов</h3> <p class="text-3xl font-bold">+3</p> </div> </div> <div class="grid gap-4 md:grid-cols-2 mt-4"> <div class="card p-4"> <h3 class="font-semibold mb-2">Нагрузка на команду</h3> <div class="relative" style="height: var(--chart-max-height);"><canvas id="teamLoadChart"></canvas></div> </div> <div class="card p-4"> <h3 class="font-semibold mb-2">Динамика дохода</h3> <div class="relative" style="height: var(--chart-max-height);"><canvas id="revenueChart"></canvas></div> </div> </div> `; }
        function renderDashboardRecruiter() { setTimeout(() => { new Chart(document.getElementById('pipelineChart'), { type: 'bar', data: { labels: ['Новые', 'Скрининг', 'Интервью', 'Оффер'], datasets: [{ label: 'Кандидатов в воронке', data: [12, 8, 5, 2], backgroundColor: '#3b82f6' }] }, options: { maintainAspectRatio: false, indexAxis: 'y' } }); }, 0); return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Сводная панель рекрутера</h1> ${renderDateRangeFilter()} </div> <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-4"> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Активных вакансий</h3><p class="text-3xl font-bold">5</p></div> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Кандидатов на рассмотрении</h3><p class="text-3xl font-bold">27</p></div> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Среднее время ответа</h3><p class="text-3xl font-bold">24 ч</p></div> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Принятых офферов</h3><p class="text-3xl font-bold">4</p></div> </div> <div class="grid gap-4 md:grid-cols-3"> <div class="md:col-span-2 card p-4"> <h3 class="font-semibold mb-2">Воронка по активным вакансиям</h3> <div class="relative" style="height: var(--chart-max-height);"><canvas id="pipelineChart"></canvas></div> </div> <div class="space-y-4"> <div class="card p-4 bg-yellow-50 border-yellow-200"> <h3 class="font-semibold text-yellow-800">❗ Требует внимания</h3> <p class="text-sm text-yellow-700 mt-2">Кандидаты по вакансии 'UI/UX Designer' ожидают фидбека в среднем 5 дней. Это создает риск их ухода.</p> </div> <div class="card p-4"> <h3 class="font-semibold mb-2">Лента активности от ${state.assistant.name}</h3> <ul class="space-y-3 text-sm"> <li><strong>${state.assistant.avatar} 14:30:</strong> Клиент оставил фидбек по <a href="#/candidates/201" class="underline">С. Романову</a></li> <li><strong>${state.assistant.avatar} 11:00:</strong> Новая вакансия <a href="#/vacancies/304" class="underline">Frontend Dev</a> от Global Tech</li> </ul> </div> </div> </div> `; }
        function renderBackButton(text = 'Назад') { return `<button onclick="window.history.back()" class="btn btn-secondary mb-4">${icons.back} ${text}</button>`; }
        
        function renderVacanciesList() { return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Вакансии</h1> <a href="#/vacancies/new" class="btn btn-primary">${icons.plus} Создать вакансию</a> </div> <div class="card"> <table class="w-full text-sm text-left"> <thead class="bg-gray-50"> <tr> <th class="p-4">Название</th><th class="p-4">Клиент</th><th class="p-4">Рекрутер</th><th class="p-4">Статистика</th><th class="p-4">Статус</th> </tr> </thead> <tbody> ${mockData.vacancies.map(v => ` <tr class="border-b"> <td class="p-4 font-medium"><a href="#/vacancies/${v.id}" class="hover:underline">${v.title}</a></td> <td class="p-4"><a href="#/clients/${mockData.clients.find(c=>c.name===v.client).id}" class="hover:underline">${v.client}</a></td> <td class="p-4">${v.recruiter}</td> <td class="p-4 text-xs text-gray-600"> <ul class="space-y-1"> <li class="flex items-center gap-2">${icons.search} <span>${v.stats.found} найдено</span></li> <li class="flex items-center gap-2">${icons.filter} <span>${v.stats.screened} отскринено</span></li> <li class="flex items-center gap-2">${icons.users} <span>${v.stats.interview} на интервью</span></li> </ul> </td> <td class="p-4"><span class="tag ${v.status === 'В работе' ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'}">${v.status}</span></td> </tr> `).join('')} </tbody> </table> </div> `; }
        function renderVacancyDetail(id) {
            const vacancy = mockData.vacancies.find(v => v.id == id) || { title: "Новая вакансия" };
            return `
                ${renderBackButton('К списку вакансий')}
                <div class="grid gap-6 lg:grid-cols-3">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="card p-6">
                             <div class="flex justify-between items-start">
                                <div>
                                     <h1 class="text-3xl font-bold mb-1">${vacancy.title}</h1>
                                     <p class="text-gray-600">Клиент: <a href="#/clients/${mockData.clients.find(c=>c.name===vacancy.client)?.id}" class="text-blue-600 hover:underline">${vacancy.client}</a></p>
                                </div>
                                 <div class="flex gap-2">
                                    <span class="tag bg-red-100 text-red-800">Срочно</span>
                                    <span class="tag bg-green-100 text-green-800">Удаленно</span>
                                </div>
                            </div>
                            <div class="mt-4">
                                <h3 class="font-semibold mb-2">Описание вакансии</h3>
                                <p class="text-sm text-gray-700">Мы ищем опытного Senior Java Developer для присоединения к нашей команде... Наш стек включает <span class="bg-yellow-100">Java 17, Spring Boot, Kafka</span>, PostgreSQL, Docker и Kubernetes. Ищем <span class="bg-yellow-100">настоящего ниндзя-разработчика</span>, готового к вызовам.</p>
                            </div>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold mb-3">Воронка кандидатов</h2>
                             <div class="card p-4">
                                <h3 class="font-semibold mb-2">Рекомендации от ${state.assistant.name}</h3>
                                <div class="space-y-2">
                                    ${mockData.candidates.slice(0,2).map(c => `
                                    <div class="border rounded-lg p-3">
                                        <div class="flex justify-between items-start">
                                            <div class="flex items-center gap-2">
                                                <img src="${c.avatar}" class="h-8 w-8 rounded-full" />
                                                <div>
                                                    <a href="#/candidates/${c.id}" class="font-semibold hover:underline">${c.name}</a>
                                                    ${c.isGem ? `<div class="tag bg-yellow-100 text-yellow-800">💎 Скрытый талант</div>` : ''}
                                                </div>
                                            </div>
                                            <span class="font-bold text-green-600">${c.match}%</span>
                                        </div>
                                        <p class="text-xs text-gray-600 mt-2"><strong>Совпадения:</strong> ${c.matches.join(', ')}</p>
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1 space-y-6">
                        <div class="card p-4">
                            <h3 class="font-semibold mb-3 border-b pb-2 flex items-center gap-2">${state.assistant.avatar} Анализ от ${state.assistant.name}</h3>
                            <div class="space-y-4 text-sm">
                                <div>
                                    <h4 class="font-medium mb-1">Анализ зарплаты ($5000)</h4>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5 relative"><div class="bg-gradient-to-r from-red-400 via-yellow-400 to-green-400 h-2.5 rounded-full" style="width: 100%;"></div><div class="absolute top-0 h-2.5 w-1 bg-black rounded-full" style="left: 40%;"></div></div>
                                    <p class="text-xs text-yellow-700 mt-1">Предложение на 15% ниже рыночной медианы. Рекомендуем: $5500-$6500.</p>
                                </div>
                                <div>
                                    <h4 class="font-medium mb-1">Анализ текста</h4>
                                    <p class="text-xs text-gray-500">Найдена фраза, которая может оттолкнуть кандидатов:</p>
                                    <p class="text-xs p-1 bg-yellow-100 rounded my-1">"...настоящего <span class="font-bold">ниндзя-разработчика</span>..."</p>
                                    <p class="text-xs text-gray-500">Рекомендация:</p>
                                    <p class="text-xs p-1 bg-green-100 rounded">"...<span class="font-bold">опытного специалиста</span>..."</p>
                                </div>
                                <div>
                                    <h4 class="font-medium mb-1">Похожие успешные профили</h4>
                                    <div class="flex items-center gap-2 border rounded p-2 text-xs">
                                        <img src="${mockData.candidates[2].avatar}" class="h-6 w-6 rounded-full" />
                                        <div>
                                            <a href="#/candidates/${mockData.candidates[2].id}" class="font-semibold hover:underline">${mockData.candidates[2].name}</a>
                                            <p class="text-gray-500">Нанят на похожую роль 3 мес. назад</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        function renderCandidatesList() { return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">База кандидатов</h1> <button class="btn btn-primary">${icons.plus} Добавить кандидата</button> </div> <div class="card"> <table class="w-full text-sm text-left"> <thead class="bg-gray-50"> <tr><th class="p-4">Имя</th><th class="p-4">Ключевые совпадения</th><th class="p-4">Желаемая ЗП</th><th class="p-4">Резюме</th></tr> </thead> <tbody> ${mockData.candidates.map(c => ` <tr class="border-b"> <td class="p-4 font-medium flex items-center gap-3"> <img src="${c.avatar}" class="h-8 w-8 rounded-full" /> <div><a href="#/candidates/${c.id}" class="hover:underline">${c.name}</a> ${c.isGem ? `<span class="tag bg-yellow-100 text-yellow-800">💎 Скрытый талант</span>` : ''}<p class="text-xs text-gray-500">${c.position}</p></div> </td> <td class="p-4 text-xs text-gray-600">${c.matches.map(m => `<div>✓ ${m}</div>`).join('')}</td> <td class="p-4 font-medium">${c.salary}</td> <td class="p-4"><button class="btn btn-secondary p-2">${icons.resume}</button></td> </tr> `).join('')} </tbody> </table> </div> `; }
        function renderCandidateProfile(id) {
            const candidate = mockData.candidates.find(c => c.id == id);
            return `
                ${renderBackButton('К базе кандидатов')}
                <div class="flex items-center gap-4 mb-6">
                    <img src="${candidate.avatar}" class="h-20 w-20 rounded-full" />
                    <div>
                        <h1 class="text-3xl font-bold">${candidate.name}</h1>
                        <p class="text-gray-500">${candidate.position}</p>
                    </div>
                </div>
                <div class="grid gap-6 md:grid-cols-3">
                    <div class="md:col-span-2 space-y-4">
                        <div class="card p-4">
                            <h3 class="font-semibold mb-2">Коммуникация с кандидатом</h3>
                            <div class="text-xs text-gray-500 mb-2">// ${state.assistant.name} сгенерировал черновик для "Вежливого отказа"</div>
                            <textarea class="w-full p-2 border rounded-md text-sm" rows="5">${`Уважаемый ${candidate.name},\n\nБлагодарим вас за интерес, проявленный к вакансии '${candidate.position}'. Мы внимательно ознакомились с вашим резюме.\n\nК сожалению, на данном этапе мы не готовы сделать вам предложение. Конкурс на данную позицию был очень высоким, и мы приняли решение в пользу кандидатов, чей опыт оказался более релевантным нашим текущим требованиям.\n\nМы сохраним ваше резюме в нашей базе данных и обязательно свяжемся с вами, если появятся подходящие вакансии в будущем.\n\nЖелаем вам успехов в поиске работы!\n\nС уважением, AI HR Portal`}</textarea>
                            <div class="flex justify-end items-center gap-2 mt-2">
                                <button class="btn btn-secondary">Отправить</button>
                                <button class="btn btn-primary">${icons.sparkles} Написать с ${state.assistant.name}</button>
                            </div>
                        </div>
                         <div class="card p-4">
                             <h3 class="font-semibold mb-2">Лента событий</h3>
                            <ul class="space-y-3 text-sm">
                                <li class="p-2 border rounded-lg"><strong>15:00, 08.09 (Ответ кандидата):</strong> "Спасибо, я подумаю над вашим предложением. Есть ли возможность обсудить проект подробнее?" <span class="tag bg-gray-100">🤔 Нейтрально</span></li>
                                <li><strong>${state.assistant.avatar} 14:30, 07.09:</strong> Запланировано интервью с клиентом через MyAssistant.</li>
                                <li><strong>11:00, 06.09:</strong> Пройдено техническое интервью. Комментарий: "Сильные хард-скиллы".</li>
                            </ul>
                        </div>
                    </div>
                    <div class="md:col-span-1">
                        <div class="card p-4">
                           <h3 class="font-semibold mb-2">Источник</h3>
                           <a href="#" class="text-blue-600 underline text-sm">${candidate.source}</a>
                           <h3 class="font-semibold mb-2 mt-4">Контактная информация</h3>
                           <p class="text-sm">s.romanov@email.com</p>
                           <p class="text-sm">+7 (926) 123-45-67</p>
                        </div>
                    </div>
                </div>
            `;
        }
        function renderClientsList() { return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Клиенты</h1> <a href="#/clients/new" class="btn btn-primary">${icons.plus} Добавить клиента</a> </div> <div class="card"> <table class="w-full text-sm text-left"> <thead class="bg-gray-50"> <tr> <th class="p-4">Название компании</th><th class="p-4">Контактное лицо</th><th class="p-4">Действия</th> </tr> </thead> <tbody> ${mockData.clients.map(c => ` <tr class="border-b"> <td class="p-4 font-medium"><a href="#/clients/${c.id}" class="hover:underline">${c.name}</a></td> <td class="p-4">${c.contact}</td> <td class="p-4"><a href="#/clients/${c.id}" class="btn btn-secondary text-xs">Просмотр</a></td> </tr> `).join('')} </tbody> </table> </div> `; }
        function renderClientDetail(id) { const client = mockData.clients.find(c => c.id == id); const clientVacancies = mockData.vacancies.filter(v => v.client === client.name); return ` ${renderBackButton('К списку клиентов')} <div class="mb-6"> <h1 class="text-3xl font-bold">${client.name}</h1> <p class="text-gray-500">Контакт: ${client.contact} (${client.email})</p> </div> <div class="grid gap-4 md:grid-cols-3 mb-4"> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Активных вакансий</h3><p class="text-3xl font-bold">${clientVacancies.filter(v => v.status === 'В работе').length}</p></div> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Всего нанято</h3><p class="text-3xl font-bold">${clientVacancies.filter(v => v.status === 'Закрыта').length}</p></div> <div class="card p-4"><h3 class="text-sm font-medium text-gray-500">Среднее время найма</h3><p class="text-3xl font-bold">38 дней</p></div> </div> <div class="grid gap-4 md:grid-cols-2"> <div class="card"> <h3 class="font-semibold p-4 border-b">Вакансии клиента</h3> <table class="w-full text-sm text-left"> <tbody>${clientVacancies.map(v => `<tr class="border-b"><td class="p-4 font-medium"><a href="#/vacancies/${v.id}" class="hover:underline">${v.title}</a></td><td class="p-4">${v.status}</td></tr>`).join('')}</tbody> </table> </div> <div class="card p-4"> <h3 class="font-semibold mb-2">История коммуникаций</h3> <ul class="space-y-3 text-sm"> <li><strong>${state.assistant.avatar} 06.09:</strong> Звонок с Виктором, обсудили новую вакансию Frontend.</li> <li><strong>01.09:</strong> Отправлен отчет за Август.</li> <li><strong>28.08:</strong> Получен фидбек по офферу для А. Петрова.</li> </ul> </div> </div> `; }
        function renderCalendar() { const days = ['Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница']; const times = ['09:00', '10:00', '11:00', '12:00', '14:00', '15:00', '16:00']; const events = { 'Вторник-11:00': { candidate: 'Мария Иванова', type: 'Тех. интервью' }, 'Среда-14:00': { candidate: 'Сергей Романов', type: 'Интервью с клиентом' } }; return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Календарь</h1> <button class="btn btn-primary" onclick="renderScheduleInterviewModal(true)">${icons.plus} Запланировать</button> </div> <div class="card p-4"> <div class="grid grid-cols-6"> <div class="border-r border-b"></div> ${days.map(day => `<div class="text-center font-semibold p-2 border-b">${day}</div>`).join('')} ${times.map(time => ` <div class="p-2 border-r font-medium text-sm text-gray-500">${time}</div> ${days.map(day => { const event = events[`${day}-${time}`]; return `<div class="border-l border-b p-1 h-20">${event ? `<div class="bg-blue-100 text-blue-800 rounded p-1 text-xs"><strong>${event.type}</strong><p>${event.candidate}</p></div>` : ''}</div>`; }).join('')} `).join('')} </div> </div> `; }
        function renderScheduleInterviewModal(show = false) { const modalContainer = document.getElementById('modal-container'); if (!show) { modalContainer.innerHTML = ''; return; } modalContainer.innerHTML = ` <div class="modal-overlay" onclick="renderScheduleInterviewModal(false)"> <div class="card w-full max-w-lg p-6" onclick="event.stopPropagation()"> <div class="flex justify-between items-center mb-4"> <h2 class="text-xl font-bold">Новая задача для ${state.assistant.name}</h2> <button onclick="renderScheduleInterviewModal(false)">${icons.close}</button> </div> <div class="space-y-4"> <div><label class="text-sm font-medium">Тип события</label><select class="w-full mt-1 p-2 border rounded-md"><option>Техническое интервью</option></select></div> <div><label class="text-sm font-medium">Кандидат</label><select class="w-full mt-1 p-2 border rounded-md"><option>Сергей Романов</option></select></div> <div><label class="text-sm font-medium">Доп. инструкции</label><textarea class="w-full mt-1 p-2 border rounded-md" placeholder="Попроси быть готовым показать код..."></textarea></div> <div class="flex justify-end gap-2"><button class="btn btn-secondary" onclick="renderScheduleInterviewModal(false)">Отмена</button><button class="btn btn-primary" onclick="renderScheduleInterviewModal(false)">Делегировать</button></div> </div> </div> `; }
        function renderAssistantSettings() {
            return `
                <h1 class="text-2xl font-bold mb-6">Настройки MyAssistant</h1>
                <div class="grid gap-6 md:grid-cols-2">
                    <div class="card p-6">
                        <h3 class="font-semibold mb-4">Персонализация</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium">Имя Ассистента</label>
                                <input type="text" id="assistantName" value="${state.assistant.name}" class="w-full mt-1 p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="text-sm font-medium">Аватар</label>
                                <div class="flex gap-2 mt-1">${['💡', '🧠', '⚙️', '✨', '🧭'].map(avatar => `<button class="p-2 text-xl rounded-full ${state.assistant.avatar === avatar ? 'bg-blue-100' : 'bg-gray-100'}" onclick="updateAssistant('avatar', '${avatar}')">${avatar}</button>`).join('')}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium">Стиль общения</label>
                                <div class="space-y-1 mt-1">${['Профессиональный', 'Дружелюбный', 'Аналитический'].map(persona => `<label class="flex items-center"><input type="radio" name="persona" value="${persona}" ${state.assistant.persona === persona ? 'checked' : ''} onchange="updateAssistant('persona', this.value)"> <span class="ml-2 text-sm">${persona}</span></label>`).join('')}</div>
                            </div>
                        </div>
                    </div>
                    <div class="card p-6">
                        <h3 class="font-semibold mb-4">Возможности Ассистента</h3>
                        <ul class="space-y-3 text-sm">
                            <li class="flex items-start"><span class="tag bg-green-100 text-green-800 mr-2">Active</span> <div><strong>Автоматический парсинг резюме</strong><p class="text-gray-500">Создает профиль кандидата из файла.</p></div></li>
                            <li class="flex items-start"><span class="tag bg-green-100 text-green-800 mr-2">Active</span> <div><strong>Предиктивное ранжирование</strong><p class="text-gray-500">Находит лучших кандидатов в базе под вакансию.</p></div></li>
                            <li class="flex items-start"><span class="tag bg-blue-100 text-blue-800 mr-2">New</span> <div><strong>Координация интервью</strong><p class="text-gray-500">Автоматически согласовывает время встреч.</p></div></li>
                            <li class="flex items-start"><span class="tag bg-yellow-100 text-yellow-800 mr-2">Soon</span> <div><strong>Первичный скрининг-звонок</strong><p class="text-gray-500">Сможет проводить короткие аудио-интервью.</p></div></li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function renderMiniPipelineChart(canvasId, data) {
            new Chart(document.getElementById(canvasId), {
                type: 'bar',
                data: {
                    labels: ['Найдено', 'Отскринено', 'Интервью'],
                    datasets: [{
                        label: 'Кандидаты',
                        data: [data.found, data.screened, data.interview],
                        backgroundColor: ['#93c5fd', '#60a5fa', '#3b82f6'],
                        barPercentage: 0.5
                    }]
                },
                options: {
                    indexAxis: 'y',
                    maintainAspectRatio: false,
                    scales: { x: { display: false }, y: { display: true, ticks: { font: { size: 10 } } } },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        // --- CLIENT & CANDIDATE RENDER FUNCTIONS ---
        function renderClientDashboard() {
            setTimeout(() => {
                mockData.vacancies
                    .filter(v => v.client === 'Global Tech Inc.')
                    .forEach(v => renderMiniPipelineChart(`chart-${v.id}`, v.stats));
            }, 0);
             return ` <div class="flex justify-between items-center mb-4"> <h1 class="text-2xl font-bold">Мои вакансии</h1> <button class="btn btn-primary">${icons.plus} Подать новую заявку</button> </div> <div class="card p-4 mb-4 bg-blue-50 border-blue-200"> <h3 class="font-semibold text-blue-800 flex items-center gap-2">${state.assistant.avatar} Сводка от вашего менеджера</h3> <p class="text-sm text-blue-700 mt-2">По вакансии "Senior Java Developer" мы нашли 3 сильных кандидатов и отправили вам шорт-лист. Ожидаем вашу обратную связь. По "Frontend Developer" продолжаем активный поиск, в воронке уже более 50 кандидатов.</p> </div> <div class="space-y-4"> ${mockData.vacancies.filter(v => v.client === 'Global Tech Inc.').map(v => ` <a href="#/client/vacancies/${v.id}" class="block card p-4 hover:bg-gray-50"> <div class="grid grid-cols-3 gap-4 items-center"> <div class="col-span-1"> <h4 class="font-semibold">${v.title}</h4> <p class="text-sm text-gray-500">${v.status}</p> </div> <div class="col-span-2"> <canvas id="chart-${v.id}" style="height: 60px;"></canvas> </div> </div> </a> `).join('')} </div> `;
        }
        function renderClientVacancyDetail(id) { return ` ${renderBackButton('К моим вакансиям')} <h1 class="text-2xl font-bold mb-4">Обзор вакансии: Senior Java Developer</h1> <h3 class="font-semibold mb-2">Кандидаты на рассмотрение (Шорт-лист)</h3> <div class="card p-4 space-y-3"> ${mockData.candidates.slice(0,3).map(c => ` <div class="flex justify-between items-center p-3 border rounded-lg"> <div class="flex items-center gap-3"> <img src="${c.avatar}" class="h-10 w-10 rounded-full" /> <div> <h4 class="font-semibold">${c.name}</h4> <p class="text-sm text-gray-500">${c.position}</p> </div> </div> <div class="flex gap-2"> <button class="btn btn-secondary text-xs">👍</button> <button class="btn btn-secondary text-xs">👎</button> <a href="#/client/candidates/${c.id}" class="btn btn-primary text-xs">Просмотреть</a> </div> </div> `).join('')} </div> `; }
        function renderClientCandidateProfile(id) { const candidate = mockData.candidates.find(c => c.id == id); return ` ${renderBackButton('К списку кандидатов')} <div class="flex items-center gap-4 mb-6"> <img src="${candidate.avatar}" class="h-20 w-20 rounded-full" /> <div> <h1 class="text-3xl font-bold">${candidate.name}</h1> <p class="text-gray-500">${candidate.position}</p> </div> </div> <div class="card p-4"> <h3 class="font-semibold mb-2">Комментарий рекрутера:</h3> <p class="text-sm italic">"Сергей показал отличные знания Java Core и опыт работы с Kafka. Рекомендую к техническому интервью."</p> <h3 class="font-semibold mt-4 mb-2">Ваша обратная связь:</h3> <textarea class="w-full p-2 border rounded-md" placeholder="Введите ваш комментарий..."></textarea> <div class="flex gap-2 mt-2"> <button class="btn btn-primary">Пригласить на следующий этап</button> <button class="btn btn-secondary">Отклонить</button> </div> </div> `; }
        function renderCandidateStatus() { return ` <h1 class="text-2xl font-bold mb-4">Статус заявки: Senior Java Developer</h1> <div class="card p-6"> <ol class="relative border-l border-gray-200"> <li class="mb-10 ml-4"> <div class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div> <h3 class="text-lg font-semibold text-gray-900">Оффер</h3> <p class="text-sm font-normal text-gray-500">Ожидается...</p> </li> <li class="mb-10 ml-4"> <div class="absolute w-3 h-3 bg-blue-600 rounded-full mt-1.5 -left-1.5 border border-white"></div> <time class="mb-1 text-sm font-normal leading-none text-gray-400">7 Сентября, 2025</time> <h3 class="text-lg font-semibold text-gray-900">Интервью с клиентом</h3> <p class="text-base font-normal text-gray-500">Вы успешно прошли интервью! Ожидайте обратную связь.</p> </li> <li class="mb-10 ml-4"> <div class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div> <time class="mb-1 text-sm font-normal leading-none text-gray-400">6 Сентября, 2025</time> <h3 class="text-lg font-semibold text-gray-900">Техническое интервью</h3> </li> <li class="ml-4"> <div class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div> <time class="mb-1 text-sm font-normal leading-none text-gray-400">4 Сентября, 2025</time> <h3 class="text-lg font-semibold text-gray-900">Заявка подана</h3> </li> </ol> </div> `; }

        const routes = {
            '/': { render: () => (state.currentUserRole === 'Руководитель' ? renderDashboardManager() : renderDashboardRecruiter()), access: ['Руководитель', 'Рекрутер'] },
            '/login': { render: renderLoginPage, access: ['Public'] },
            '/vacancies': { render: renderVacanciesList, access: ['Руководитель', 'Рекрутер'] },
            '/vacancies/:id': { render: (params) => renderVacancyDetail(params.id), access: ['Руководитель', 'Рекрутер'] },
            '/candidates': { render: renderCandidatesList, access: ['Рекрутер'] },
            '/candidates/:id': { render: (params) => renderCandidateProfile(params.id), access: ['Рекрутер'] },
            '/clients': { render: renderClientsList, access: ['Руководитель', 'Рекрутер'] },
            '/clients/:id': { render: (params) => renderClientDetail(params.id), access: ['Руководитель', 'Рекрутер'] },
            '/calendar': { render: renderCalendar, access: ['Рекрутер'] },
            '/settings/my-assistant': { render: renderAssistantSettings, access: ['Руководитель', 'Рекрутер'] },
            '/client/dashboard': { render: renderClientDashboard, access: ['Клиент'] },
            '/client/vacancies/:id': { render: (params) => renderClientVacancyDetail(params.id), access: ['Клиент'] },
            '/client/candidates/:id': { render: (params) => renderClientCandidateProfile(params.id), access: ['Клиент'] },
            '/candidate/status/:id': { render: (params) => renderCandidateStatus(params.id), access: ['Кандидат'] },
        };
        
        // --- ROUTER & APP LOGIC ---
        function router() {
            const pathWithParams = window.location.hash.slice(1) || '/';
            const appRoot = document.getElementById('app-root');
            let path = '/' + pathWithParams.split('/')[1];
            if (path === '/undefined') path = '/';

            let route, params = {};
            const pathParts = pathWithParams.split('/');
            for (let routePath in routes) {
                const routeParts = routePath.split('/');
                if (routeParts.length === pathParts.length) {
                    let match = true;
                    let currentParams = {};
                    for (let i = 0; i < routeParts.length; i++) {
                        if (routeParts[i].startsWith(':')) { currentParams[routeParts[i].substring(1)] = pathParts[i]; } 
                        else if (routeParts[i] !== pathParts[i]) { match = false; break; }
                    }
                    if (match) {
                        route = routes[routePath];
                        params = currentParams;
                        path = routePath.includes(':id') ? '/' + routePath.split('/')[1] : routePath;
                        break;
                    }
                }
            }
            
            renderSidebar(state.currentUserRole, path);

            if (route && (route.access.includes(state.currentUserRole) || route.access.includes('Public'))) {
                appRoot.innerHTML = route.render(params);
            } else {
                switch(state.currentUserRole) {
                    case 'Руководитель': case 'Рекрутер': window.location.hash = '/'; break;
                    case 'Клиент': window.location.hash = '/client/dashboard'; break;
                    case 'Кандидат': window.location.hash = '/candidate/status/1'; break;
                    default: window.location.hash = '/login';
                }
            }
        }
        
        function updateAssistant(key, value) {
            if (key === 'name') {
                const newName = document.getElementById('assistantName').value;
                state.assistant.name = newName || 'Jessica';
            } else {
                state.assistant[key] = value;
            }
            router(); // Re-render to reflect changes
        }

        function initApp() {
            const roleSelect = document.getElementById('role-select');
            roleSelect.addEventListener('change', (e) => {
                state.currentUserRole = e.target.value;
                renderHeader(state.currentUserRole);
                router();
            });
            roleSelect.value = state.currentUserRole;
            renderHeader(state.currentUserRole);
            window.addEventListener('hashchange', router);
            document.addEventListener('input', (e) => {
                if(e.target.id === 'assistantName') {
                    updateAssistant('name', e.target.value);
                }
            });
            router();
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>